<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validación de Invitado - Boda A&G</title>
    <link rel="icon" href="assets/images/AG.png" type="image/png">
    <link rel="apple-touch-icon" href="assets/images/AG.png">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes:wght@400&family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/css/validar.css">
    <script src="https://kit.fontawesome.com/171beeb065.js" crossorigin="anonymous"></script>
    <!-- Librería jsQR para detección de códigos QR -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>
<body>
    <!-- Partículas flotantes -->
    <div class="floating-particles" id="particles"></div>

    <div class="validation-container">
        <div class="validation-logo">
            <img src="assets/images/AG.png" alt="Logo Boda A&G">
        </div>
        <p class="wedding-context">Alejandra & Gerardo</p>
        <p style="font-size: 0.9em; color: #b0b0b0; margin-bottom: 30px; font-style: italic;">11 de Octubre, 2025</p>
        
        <h2>Validación de Pase</h2>
        
        <div id="guest-details" class="guest-details" style="display: none;">
            <p><strong>Nombre:</strong> <span id="val-guest-name">---</span></p>
            <p><strong>ID:</strong> <span id="val-guest-id">---</span></p>
            <p><strong>Estado:</strong> <span id="val-status">---</span></p>
            <p><strong>Pases Asignados:</strong> <span id="val-passes">---</span></p>
            <p><strong>Niños Asignados:</strong> <span id="val-kids">---</span></p>
            <p id="mesa-row" style="display: none;"><strong>Mesa:</strong> <span id="val-mesa">---</span></p>
        </div>
        
        <div id="confirmation-details" class="guest-details" style="display: none;">
            <h3 style="color: #d1b7a0; margin-bottom: 20px; font-family: 'Playfair Display', serif; font-size: 1.5em; text-align: center;">Detalles de Confirmación</h3>
            <p><strong>Pases Utilizados:</strong> <span id="val-passes-used">---</span></p>
            <p><strong>Niños Utilizados:</strong> <span id="val-kids-used">---</span></p>
            <p><strong>Nombres Adultos:</strong> <div id="val-adult-names">---</div></p>
            <p id="kids-names-row" style="display: none;"><strong>Nombres Niños:</strong> <div id="val-kids-names">---</div></p>
            <p><strong>Teléfono:</strong> <span id="val-phone">---</span></p>
            <p id="email-row" style="display: none;"><strong>Email:</strong> <span id="val-email">---</span></p>
            <p><strong>Fecha Confirmación:</strong> <span id="val-confirmation-date">---</span></p>
        </div>
        
        <div class="validation-form">
            <div class="input-group">
                <label for="guestId">ID del Invitado:</label>
                <div class="input-with-button">
                    <input 
                        type="text" 
                        id="guestId" 
                        placeholder="Ingresa el ID (6 caracteres)"
                        maxlength="6"
                        autocomplete="off"
                    >
                    <button type="button" id="scanQRBtn" class="scan-btn" title="Escanear QR">
                        <i class="fas fa-qrcode"></i>
                    </button>
            </div>
            </div>
            
            <!-- Interfaz de cámara QR -->
            <div id="cameraInterface" class="camera-interface" style="display: none;">
                <div class="camera-header">
                    <h3>Escanear Código QR</h3>
                    <button type="button" id="closeCameraBtn" class="close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="camera-container">
                    <div id="cameraPreview" class="camera-preview">
                        <div class="camera-placeholder">
                            <i class="fas fa-camera"></i>
                            <p>Iniciando cámara...</p>
                        </div>
                    </div>
                    <div class="camera-controls">
                        <button type="button" id="switchCameraBtn" class="control-btn">
                            <i class="fas fa-sync-alt"></i> Cambiar Cámara
                        </button>
                        <button type="button" id="toggleFlashBtn" class="control-btn">
                            <i class="fas fa-lightbulb"></i> Flash
                        </button>
                        
                    </div>
                </div>
            </div>

            <button type="submit" id="validateBtn" class="validate-btn">
                <i class="fas fa-search"></i>
                Validar Invitado
            </button>
        </div>
        
        <p id="status-message" class="status-message">Ingresa el ID del invitado o escanea el código QR</p>
    </div>

    <!-- Configuración del sistema -->
    <script src="src/js/validar-config.js"></script>
    <!-- Script principal simplificado -->
    <script src="src/js/validar.js?v=1754370293418"></script>
    
    <script>
        // Crear partículas flotantes optimizadas para móvil
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            
            // Reducir partículas en móvil para mejor rendimiento
            const isMobile = window.innerWidth <= 480;
            const particleCount = isMobile ? 8 : 15;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                
                // Reducir opacidad en móvil
                if (isMobile) {
                    particle.style.opacity = '0.3';
                }
                
                particlesContainer.appendChild(particle);
            }
        }

        // Optimizar rendimiento en móvil
        function optimizeForMobile() {
            if (window.innerWidth <= 480) {
                // Reducir animaciones complejas en móvil
                document.body.style.setProperty('--animation-duration', '0.3s');
                
                // Mejorar el scroll suave
                document.documentElement.style.scrollBehavior = 'smooth';
            }
        }
        
        // Inicializar partículas y optimizaciones cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            optimizeForMobile();
        });

        // Re-optimizar si cambia la orientación
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                optimizeForMobile();
                
                // Recrear partículas si es necesario
                const particlesContainer = document.getElementById('particles');
                if (particlesContainer) {
                    particlesContainer.innerHTML = '';
                    createParticles();
                }
            }, 100);
        });
    </script>
</body>
</html>